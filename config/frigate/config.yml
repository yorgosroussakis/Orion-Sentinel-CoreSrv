# ============================================================================
# Frigate NVR Configuration - Orion-Sentinel-CoreSrv
# ============================================================================
#
# This is the main Frigate configuration file.
# Edit this file with your camera IPs and credentials.
#
# TAPO CAMERA SETUP:
# 1. Open Tapo app → Camera Settings → Advanced Settings → Camera Account
# 2. Create a username and password (separate from your Tapo account)
# 3. Replace TAPO_USER, TAPO_PASS, and CAMERA_IP below with your values
#
# RTSP URL FORMAT:
#   - High quality (1080p): rtsp://USER:PASS@CAMERA_IP:554/stream1
#   - Low quality (360p):   rtsp://USER:PASS@CAMERA_IP:554/stream2
#
# For more options: https://docs.frigate.video/configuration/
# ============================================================================

# ============================================================================
# MQTT INTEGRATION (Optional)
# ============================================================================
# MQTT enables real-time event notifications and Home Assistant integration.
# Frigate works fine without MQTT - just leave this section disabled.
#
# To enable MQTT:
# 1. Uncomment the mqtt section below
# 2. Update the host to your MQTT broker (use 'orion_mosquitto' for home stack)
# 3. Update user/password if your broker requires authentication
mqtt:
  enabled: false
  # host: orion_mosquitto
  # port: 1883
  # user: frigate
  # password: your_mqtt_password
  # topic_prefix: frigate
  # client_id: frigate

# ============================================================================
# DETECTORS - Object detection configuration
# ============================================================================
# CPU detection works out of the box but is slower.
# For better performance, consider adding a Coral TPU.
detectors:
  # CPU detector (default, no extra hardware needed)
  cpu1:
    type: cpu
    num_threads: 2

  # ---- CORAL USB ACCELERATOR ----
  # Provides ~10x faster detection than CPU
  # To enable:
  # 1. Uncomment the coral section below
  # 2. Uncomment the USB device mapping in cam_nvr.compose.yml
  # coral:
  #   type: edgetpu
  #   device: usb

  # ---- CORAL PCIe/M.2 ----
  # coral:
  #   type: edgetpu
  #   device: pci

# ============================================================================
# FFMPEG - Global transcoding settings
# ============================================================================
ffmpeg:
  # Hardware acceleration (uncomment for Intel QSV)
  # Also uncomment /dev/dri device in cam_nvr.compose.yml
  # hwaccel_args: preset-vaapi

  # For NVIDIA (requires nvidia-docker):
  # hwaccel_args: preset-nvidia-h264

  # Output arguments for recordings
  output_args:
    record: preset-record-generic-audio-aac

# ============================================================================
# RECORDING - Event-only recording settings
# ============================================================================
# Configure for event-only recording (no continuous 24/7 footage)
# Only motion/object-detection events are kept
record:
  enabled: true
  # Do not keep non-event recordings (continuous footage)
  retain:
    days: 0
    mode: motion
  # Event recording settings
  events:
    pre_capture: 5        # seconds before event
    post_capture: 10      # seconds after event
    objects:
      - person
      - car
      - dog
      - cat
    retain:
      default: 14         # keep event clips on primary storage for 14 days
      mode: active_objects

# ============================================================================
# SNAPSHOTS - Image capture on events
# ============================================================================
snapshots:
  enabled: true
  crop: true
  bounding_box: true
  retain:
    default: 14

# ============================================================================
# DETECTION - Object detection settings
# ============================================================================
detect:
  enabled: true
  fps: 5
  width: 1280
  height: 720

# ============================================================================
# OBJECTS - What to detect
# ============================================================================
objects:
  track:
    - person
    - car
    - dog
    - cat
  filters:
    person:
      min_score: 0.5
      min_area: 5000
      max_area: 100000
    car:
      min_score: 0.5
      min_area: 10000

# ============================================================================
# CAMERAS - 7 Camera Configuration
# ============================================================================
# Replace RTSP_USER, RTSP_PASS, and IP addresses with your actual values.
#
# TAPO CAMERA SETUP:
# 1. Open Tapo app → Camera Settings → Advanced Settings → Camera Account
# 2. Create a username and password (this is separate from your Tapo account)
# 3. Use these credentials below for RTSP_USER and RTSP_PASS
#
# IP ADDRESS SCHEME:
# - cam1: 192.168.10.11
# - cam2: 192.168.10.12
# - cam3: 192.168.10.13
# - cam4: 192.168.10.14
# - cam5: 192.168.10.15
# - cam6: 192.168.10.16
# - cam7: 192.168.10.17

cameras:
  # ---- CAMERA 1: LIVING ROOM ----
  cam1_living_room:
    enabled: true
    ffmpeg:
      inputs:
        # High-res stream for recording (1080p)
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.11:554/stream1
          roles:
            - record
        # Lower-res stream for detection (360p)
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.11:554/stream2
          roles:
            - detect
    detect:
      enabled: true
      width: 640
      height: 360
      fps: 5
    objects:
      track:
        - person
        - dog
    record:
      enabled: true

  # ---- CAMERA 2: KITCHEN ----
  cam2_kitchen:
    enabled: true
    ffmpeg:
      inputs:
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.12:554/stream1
          roles:
            - record
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.12:554/stream2
          roles:
            - detect
    detect:
      enabled: true
      width: 640
      height: 360
      fps: 5
    objects:
      track:
        - person
    record:
      enabled: true

  # ---- CAMERA 3: HALLWAY ----
  cam3_hallway:
    enabled: true
    ffmpeg:
      inputs:
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.13:554/stream1
          roles:
            - record
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.13:554/stream2
          roles:
            - detect
    detect:
      enabled: true
      width: 640
      height: 360
      fps: 5
    objects:
      track:
        - person
    record:
      enabled: true

  # ---- CAMERA 4: KIDS ROOM ----
  cam4_kids_room:
    enabled: true
    ffmpeg:
      inputs:
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.14:554/stream1
          roles:
            - record
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.14:554/stream2
          roles:
            - detect
    detect:
      enabled: true
      width: 640
      height: 360
      fps: 5
    objects:
      track:
        - person
    record:
      enabled: true

  # ---- CAMERA 5: OFFICE ----
  cam5_office:
    enabled: true
    ffmpeg:
      inputs:
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.15:554/stream1
          roles:
            - record
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.15:554/stream2
          roles:
            - detect
    detect:
      enabled: true
      width: 640
      height: 360
      fps: 5
    objects:
      track:
        - person
    record:
      enabled: true

  # ---- CAMERA 6: BACKYARD ----
  cam6_backyard:
    enabled: true
    ffmpeg:
      inputs:
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.16:554/stream1
          roles:
            - record
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.16:554/stream2
          roles:
            - detect
    detect:
      enabled: true
      width: 640
      height: 360
      fps: 5
    objects:
      track:
        - person
        - car
        - dog
        - cat
    record:
      enabled: true

  # ---- CAMERA 7: FRONT DOOR ----
  cam7_front_door:
    enabled: true
    ffmpeg:
      inputs:
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.17:554/stream1
          roles:
            - record
        - path: rtsp://RTSP_USER:RTSP_PASS@192.168.10.17:554/stream2
          roles:
            - detect
    detect:
      enabled: true
      width: 640
      height: 360
      fps: 5
    objects:
      track:
        - person
        - car
    record:
      enabled: true

# ============================================================================
# UI / WEB INTERFACE
# ============================================================================
ui:
  live:
    stream_name: mse
  time_format: browser

# ============================================================================
# BIRDSEYE - Multi-camera overview
# ============================================================================
birdseye:
  enabled: true
  mode: continuous
  width: 1920
  height: 1080

# ============================================================================
# GO2RTC - RTSP restreaming
# ============================================================================
# Access restreams at: rtsp://frigate-host:8554/<camera_name>
go2rtc:
  streams:
    cam1_living_room:
      - rtsp://RTSP_USER:RTSP_PASS@192.168.10.11:554/stream1
    cam2_kitchen:
      - rtsp://RTSP_USER:RTSP_PASS@192.168.10.12:554/stream1
    cam3_hallway:
      - rtsp://RTSP_USER:RTSP_PASS@192.168.10.13:554/stream1
    cam4_kids_room:
      - rtsp://RTSP_USER:RTSP_PASS@192.168.10.14:554/stream1
    cam5_office:
      - rtsp://RTSP_USER:RTSP_PASS@192.168.10.15:554/stream1
    cam6_backyard:
      - rtsp://RTSP_USER:RTSP_PASS@192.168.10.16:554/stream1
    cam7_front_door:
      - rtsp://RTSP_USER:RTSP_PASS@192.168.10.17:554/stream1

# ============================================================================
# LOGGER
# ============================================================================
logger:
  default: info
  # logs:
  #   frigate.record: debug
