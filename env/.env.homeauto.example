# Orion-Sentinel Home Automation Module Configuration
# Home Assistant + Mosquitto + Zigbee2MQTT + Mealie + DSMR Reader
#
# Usage:
#   1. Copy this file: cp env/.env.homeauto.example env/.env.homeauto
#   2. Edit the file to customize your settings
#   3. Start home automation: ./scripts/orionctl up homeauto

# =============================================================================
# USER/GROUP & TIMEZONE
# =============================================================================
PUID=1000
PGID=1000
TZ=Europe/Amsterdam

# =============================================================================
# HOST DIRECTORY PATHS
# =============================================================================
# Home automation config root: all home automation service configurations
HOMEAUTO_CONFIG_ROOT=/srv/docker/homeauto

# Domain for Traefik routing (requires gateway module)
DOMAIN=local

# Directory structure:
# /srv/docker/homeauto/
# ├── homeassistant/       # Home Assistant configuration
# ├── mosquitto/
# │   ├── mosquitto.conf   # MQTT broker config
# │   ├── data/            # Persistence
# │   └── log/             # Logs
# ├── zigbee2mqtt/
# │   └── data/            # Zigbee device database
# ├── mealie/              # Recipe data
# └── dsmr/
#     ├── app/             # DSMR Reader app
#     └── db/              # PostgreSQL data

# =============================================================================
# HARDWARE DEVICES
# =============================================================================
# Zigbee USB coordinator device path
# Common paths:
#   - /dev/ttyACM0 (most USB Zigbee coordinators)
#   - /dev/ttyUSB0 (some older models)
#   - /dev/serial/by-id/usb-... (persistent device path, recommended)
#
# Find your device: ls -l /dev/serial/by-id/
ZIGBEE_DEVICE=/dev/ttyACM0

# DSMR (Dutch smart meter) serial port
# Only needed if using DSMR Reader
DSMR_SERIAL_PORT=/dev/ttyUSB0

# =============================================================================
# MEALIE (Recipe Management)
# =============================================================================
# Allow new user signups (set to 'false' after creating admin account)
MEALIE_ALLOW_SIGNUP=true

# =============================================================================
# DSMR READER (Dutch Smart Meter - Optional)
# =============================================================================
# DSMR Reader is only relevant for Dutch smart meters with P1 port.
# Use profile 'dsmr' to enable: ./scripts/orionctl up homeauto dsmr

# Database configuration
DSMR_DB_NAME=dsmrreader
DSMR_DB_USER=dsmrreader
DSMR_DB_PASSWORD=changeme_generate_random_password

# DSMR Reader web interface credentials
DSMR_USER=admin
DSMR_EMAIL=admin@local
DSMR_PASSWORD=changeme_use_strong_password

# =============================================================================
# QUICK START
# =============================================================================
# 1. Create directories:
#    sudo mkdir -p /srv/docker/homeauto/{homeassistant,mosquitto/{data,log},zigbee2mqtt/data,mealie}
#    sudo chown -R $USER:$USER /srv/docker/homeauto
#
# 2. Create Mosquitto config:
#    cat > /srv/docker/homeauto/mosquitto/mosquitto.conf << 'EOF'
#    listener 1883
#    listener 9001
#    protocol websockets
#    allow_anonymous true
#    persistence true
#    persistence_location /mosquitto/data/
#    log_dest file /mosquitto/log/mosquitto.log
#    EOF
#
# 3. Copy env file:
#    cp env/.env.homeauto.example env/.env.homeauto
#
# 4. Start the gateway first (required for Traefik routing):
#    ./scripts/orionctl up gateway
#
# 5. Start home automation:
#    ./scripts/orionctl up homeauto
#
# 6. Access services:
#    https://ha.local      - Home Assistant
#    https://zigbee.local  - Zigbee2MQTT
#    https://mealie.local  - Mealie (recipes)
#    https://energy.local  - DSMR Reader (if enabled)

# =============================================================================
# HOME ASSISTANT INTEGRATIONS
# =============================================================================
# After starting, configure these integrations in Home Assistant:
#
# 1. MQTT Integration
#    - Settings → Devices & Services → Add Integration → MQTT
#    - Broker: orion_mosquitto, Port: 1883
#
# 2. Zigbee2MQTT
#    - Devices should auto-discover via MQTT
#
# 3. For media integration:
#    - Add Jellyfin integration (via HACS)
#    - Point to http://orion_jellyfin:8096

# =============================================================================
# HARDWARE REQUIREMENTS
# =============================================================================
# For full functionality, you'll need:
#
# 1. Zigbee USB Coordinator (for Zigbee2MQTT)
#    - Recommended: Sonoff Zigbee 3.0 USB Dongle Plus (~€15-30)
#    - Alternative: ConBee II, CC2531, CC2652
#
# 2. P1 Cable (for DSMR Reader - Netherlands only)
#    - USB to P1 RJ12 cable (~€15-25)
#
# If you don't have the hardware:
# - Comment out zigbee2mqtt in the compose file
# - Don't use the dsmr profile
# - Home Assistant and Mealie work without special hardware

# =============================================================================
# STANDALONE MODE (without Gateway)
# =============================================================================
# If you want to run home automation without the gateway module,
# add port mappings to the compose file:
#
#   ports:
#     - "8123:8123"  # Home Assistant
#     - "8080:8080"  # Zigbee2MQTT
#     - "9000:9000"  # Mealie
#
# Then access via:
#   http://localhost:8123  - Home Assistant
#   http://localhost:8080  - Zigbee2MQTT
#   http://localhost:9000  - Mealie
